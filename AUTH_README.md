# –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π —Å–µ—Å—Å–∏–µ–π

## üìã –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

‚úÖ **–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏**
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
- –†–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –ø–æ —Ä–æ–ª—è–º (user/admin)

‚úÖ **–û–¥–Ω–∞ —Å–µ—Å—Å–∏—è –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**
- –ü—Ä–∏ –≤—Ö–æ–¥–µ —Å –Ω–æ–≤–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Å—Ç–∞—Ä–∞—è —Å–µ—Å—Å–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è
- –ü—Ä–µ–¥—ã–¥—É—â–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–ª—É—á–∞–µ—Ç –æ—à–∏–±–∫—É 403 –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/login`

‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Å—Å–∏–∏**
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Ç–æ–∫–µ–Ω–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞ –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ —Å–µ—Å—Å–∏–∏

‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞**
- –í—Å–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ `/login`

---

## üîß –°–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –º–æ–¥–µ–ª–∏ User

```javascript
// –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è:
currentToken: String    // –¢–µ–∫—É—â–∏–π –∞–∫—Ç–∏–≤–Ω—ã–π —Ç–æ–∫–µ–Ω (–æ–¥–Ω–∞ —Å–µ—Å—Å–∏—è)
refreshToken: String    // –¢–æ–∫–µ–Ω –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
status: enum ['guest', 'registered', 'active']
```

### –ù–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

#### –ü—É–±–ª–∏—á–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
- `POST /api/user/register` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- `POST /api/user/login` - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

#### –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã (—Ç—Ä–µ–±—É—é—Ç —Ç–æ–∫–µ–Ω)
- `GET /api/user/me` - –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `GET /api/user/check-session` - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å —Å–µ—Å—Å–∏–∏

### Middleware –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

`authMiddleware` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
1. –ù–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–∞ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ
2. –í–∞–ª–∏–¥–Ω–æ—Å—Ç—å JWT —Ç–æ–∫–µ–Ω–∞
3. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç–æ–∫–µ–Ω–∞ —Ç–µ–∫—É—â–µ–º—É —Ç–æ–∫–µ–Ω—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î
4. –°—Ç–∞—Ç—É—Å –∞–∫–∫–∞—É–Ω—Ç–∞ (active)

**–ü—Ä–∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Ç–æ–∫–µ–Ω–∞** - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `403` —Å —Ñ–ª–∞–≥–æ–º `sessionExpired: true`

---

## üíª –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —á–∞—Å—Ç—å

### AuthContext

–ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:
- `user` - –¥–∞–Ω–Ω—ã–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `loading` - —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏
- `login(email, password)` - —Ñ—É–Ω–∫—Ü–∏—è –≤—Ö–æ–¥–∞
- `register(fullName, email, phone, password)` - —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- `logout()` - —Ñ—É–Ω–∫—Ü–∏—è –≤—ã—Ö–æ–¥–∞
- `checkSession()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Å–µ—Å—Å–∏–∏

### ProtectedRoute

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –∑–∞—â–∏—Ç—ã –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤:
```tsx
<ProtectedRoute>
    <Main />
</ProtectedRoute>

<ProtectedRoute requiredRole="admin">
    <AdminMain />
</ProtectedRoute>
```

### –°—Ç—Ä–∞–Ω–∏—Ü—ã

- `/login` - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞
- `/register` - –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- `/` - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∑–∞—â–∏—â–µ–Ω–∞)
- `/admin` - –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (–∑–∞—â–∏—â–µ–Ω–∞, —Ç–æ–ª—å–∫–æ –¥–ª—è admin)

---

## üîê –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–¥–Ω–∞ —Å–µ—Å—Å–∏—è

1. **–ü—Ä–∏ –≤—Ö–æ–¥–µ** (login):
   - –°–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω
   - –¢–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ø–æ–ª–µ `currentToken` –≤ –ë–î
   - –°—Ç–∞—Ä—ã–π —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º

2. **–ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –∫ API**:
   - Middleware –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ === `currentToken` –≤ –ë–î
   - –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω—ã –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç ‚Üí 403 –æ—à–∏–±–∫–∞ —Å `sessionExpired: true`

3. **–ù–∞ –∫–ª–∏–µ–Ω—Ç–µ**:
   - –ü—Ä–∏ 403 —Å `sessionExpired` ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π logout –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/login`
   - –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Å—Å–∏–∏ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–°–µ—Ä–≤–µ—Ä** (`/server/.env`):
```env
PORT=3000
MONGOURL=mongodb://localhost:27017/your_database
SecretKey=your_secret_key_for_access_token
SecretKeyRefresh=your_secret_key_for_refresh_token
```

**–ö–ª–∏–µ–Ω—Ç** (`/client/.env`):
```env
VITE_API_URL=http://localhost:3000
```

### –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

**–°–µ—Ä–≤–µ—Ä:**
```bash
cd server
npm install
npm start
```

**–ö–ª–∏–µ–Ω—Ç:**
```bash
cd client
npm install
npm run dev
```

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AuthContext –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

```tsx
import { useAuth } from "../contexts/AuthContext";

function MyComponent() {
    const { user, logout } = useAuth();
    
    return (
        <div>
            <p>–ü—Ä–∏–≤–µ—Ç, {user?.fullName}!</p>
            <button onClick={logout}>–í—ã–π—Ç–∏</button>
        </div>
    );
}
```

### –í—ã–∑–æ–≤ –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

```tsx
import api from "../api";

// –¢–æ–∫–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –∑–∞–≥–æ–ª–æ–≤–æ–∫
const response = await api.get("/api/user/me");
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–æ–≤**: –¢–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `localStorage`. –í production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å httpOnly cookies.

2. **–í—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Ç–æ–∫–µ–Ω–∞**: –°–µ–π—á–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ 30 –¥–Ω–µ–π. –ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ `UserController.js`:
   ```javascript
   expiresIn: "30d" // –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞ –Ω—É–∂–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Å—Å–∏–∏**: –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç. –ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ `AuthContext.tsx`:
   ```typescript
   5 * 60 * 1000 // 5 –º–∏–Ω—É—Ç –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
   ```

4. **–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏:
   - `admin` ‚Üí `/admin`
   - `user` ‚Üí `/`

---

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏
```javascript
localStorage.getItem("token")
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Å—Å–∏–∏
```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
await fetch("http://localhost:3000/api/user/check-session", {
    headers: {
        "Authorization": localStorage.getItem("token")
    }
})
```

---

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –°–µ—Ä–≤–µ—Ä
- `express` - –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- `mongoose` - MongoDB ODM
- `bcrypt` - —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
- `jsonwebtoken` - JWT —Ç–æ–∫–µ–Ω—ã
- `cors` - CORS middleware

### –ö–ª–∏–µ–Ω—Ç
- `react-router-dom` - –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
- `axios` - HTTP –∫–ª–∏–µ–Ω—Ç
- `react-toastify` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

---

## ‚ú® –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø–∞—Ä–æ–ª—è
- ‚úÖ –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–µ—Å—Å–∏—è –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–π —Å–µ—Å—Å–∏–∏
- ‚úÖ –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
- ‚úÖ –†–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ —Ä–æ–ª—è–º
- ‚úÖ –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Å—Å–∏–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π logout –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ —Å–µ—Å—Å–∏–∏
- ‚úÖ –ö—Ä–∞—Å–∏–≤—ã–π UI –¥–ª—è Login/Register
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üéâ

